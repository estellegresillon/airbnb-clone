{"ast":null,"code":"var _jsxFileName = \"/Users/estellegresillon/Code/airbnb-redux/src/components/detail/detail-mobile.jsx\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { setRestaurants } from \"../../actions\";\n\nconst DetailMobile = props => {\n  const {\n    setRestaurants,\n    restaurants,\n    match,\n    location\n  } = props;\n  const {\n    0: restaurant,\n    1: setRestaurant\n  } = useState({});\n  const {\n    0: similarRestaurants,\n    1: setSimilarRestaurants\n  } = useState([]);\n  const nextRestaurantRef = useRef(null);\n  const previousRestaurantRef = useRef(null);\n  const detailPageTop = useRef(null);\n  const listedRestaurants = location.listedRestaurants;\n\n  const scrollToDetailTop = () => {\n    detailPageTop.current.scrollIntoView();\n  };\n\n  const setNavigation = restaurantList => {\n    let previous;\n    let next;\n    restaurantList.forEach((val, i) => {\n      if (val.id.toString() === match.params.id) {\n        previous = restaurantList[i - 1];\n        next = restaurantList[i + 1];\n      }\n\n      ;\n    });\n\n    if (previous) {\n      previousRestaurantRef.current = previous.id;\n    }\n\n    ;\n\n    if (next) {\n      nextRestaurantRef.current = next.id;\n    }\n\n    ;\n  }; // if a user arrives on the pageId directly \n  // he doesn't get the restaurant object in the props so we execute these 2 hooks\n\n\n  useEffect(() => {\n    if (!location.restaurant) {\n      setRestaurants();\n    }\n\n    ;\n  }, [location.restaurant, setRestaurants]);\n  useEffect(() => {\n    if (location.listedRestaurants) {\n      setNavigation(location.listedRestaurants);\n    } else {\n      //\n      setNavigation(restaurants);\n    }\n\n    ;\n\n    if (location.restaurant) {\n      setRestaurant(location.restaurant);\n      const filterByType = [...restaurants].filter(val => {\n        if (val.type && val.name !== location.restaurant.name) {\n          return val.type === location.restaurant.type;\n        } else return null;\n      });\n      setSimilarRestaurants(filterByType.slice(0, 6));\n    } else {\n      const detailRestaurant = [...restaurants].filter(val => {\n        if (val.id) {\n          return val.id.toString() === match.params.id;\n        } else return null;\n      });\n      setRestaurant(detailRestaurant[0]);\n      const filterByType = [...restaurants].filter(val => {\n        if (val.type && val.name !== detailRestaurant[0].name) {\n          return val.type === detailRestaurant[0].type;\n        } else return null;\n      });\n      setSimilarRestaurants(filterByType.slice(0, 6));\n    }\n\n    ; // eslint-disable-next-line\n  }, [location.restaurant, restaurants, match.params.id]); // go to top because it keeps the same scroll position as the previous page\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n\n  const handleNavigation = (direction, id) => {\n    if (direction === \"left\") {\n      if (previousRestaurantRef.current) {\n        props.history.push({\n          pathname: \"/detail/\".concat(previousRestaurantRef.current),\n          listedRestaurants\n        });\n      }\n\n      ;\n    } else if (direction === \"next-page\") {\n      props.history.push({\n        pathname: \"/detail/\".concat(id),\n        listedRestaurants\n      });\n    } else if (direction === \"right\") {\n      if (nextRestaurantRef.current) {\n        props.history.push({\n          pathname: \"/detail/\".concat(nextRestaurantRef.current),\n          listedRestaurants\n        });\n      }\n\n      ;\n    }\n\n    ;\n    scrollToDetailTop();\n  };\n\n  return restaurant ? __jsx(\"div\", {\n    className: \"detail-page-wrapper-mobile\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"button-go-back\",\n    onClick: () => props.history.goBack(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-chevron-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }), \" Retour\"), restaurant.award && __jsx(\"div\", {\n    className: \"detail-page-award\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, restaurant.award.description), __jsx(\"div\", {\n    className: \"detail-page-big-img\",\n    style: {\n      backgroundImage: \"url(\".concat(restaurant.imageUrl, \")\"),\n      backgroundPosition: \"center\",\n      backgroundSize: \"cover\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    key: location.pathname,\n    className: \"detail-page-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"detail-page-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, restaurant.name), __jsx(\"ul\", {\n    className: \"detail-page-resume\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    className: \"bolder\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, \"Type :\"), \" \", restaurant.type, \" (\", restaurant.price, \")\"), __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    className: \"bolder\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"Note :\"), \" \", restaurant.rate, \"/5 (+ de \", restaurant.votes, \" votes Google)\"), __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, restaurant.address), __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    className: \"bolder\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, \"Horaires :\"), \" \", restaurant.openingHours), __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    className: \"bolder\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"T\\xE9l\\xE9phone :\"), \" \", restaurant.phone || \"Non communiqué\"), __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    href: restaurant.menuLink,\n    target: \"_blank\",\n    className: \"see-menu\",\n    rel: \"noopener noreferrer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, \"Voir le menu\")))), __jsx(\"div\", {\n    className: \"detail-page-reviews\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"foodlab-review\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"foodlab-review-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, \"Avis FoodLab : \"), restaurant.foodlabreview ? \"\\xAB \".concat(restaurant.foodlabreview, \" \\xBB\") : \"Rédaction en cours\"), __jsx(\"ul\", {\n    className: \"customers-reviews\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, restaurant.reviews ? restaurant.reviews.map((review, i) => {\n    return __jsx(\"li\", {\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"review-date\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"Review utilisateur \", i + 1, \" - le \", review.date, \" :\"), __jsx(\"div\", {\n      className: \"review-comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"\\\"\", review.comment, \"\\\"\"));\n  }) : __jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, \"Pas de reviews enregistr\\xE9es\"))), restaurant.imageUrl2 && __jsx(\"div\", {\n    className: \"detail-page-cropped-img\",\n    style: {\n      backgroundImage: \"url(\".concat(restaurant.imageUrl2, \")\"),\n      backgroundPosition: \"right\",\n      backgroundSize: \"cover\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }), similarRestaurants.length > 0 && __jsx(\"div\", {\n    className: \"bottom-section\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"bottom-section-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Restaurants similaires :\"), __jsx(\"div\", {\n    className: \"similar-restaurants-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, similarRestaurants.map(simRest => {\n    return __jsx(\"div\", {\n      className: \"similar-restaurant-card\",\n      key: simRest.id,\n      onClick: () => handleNavigation(\"next-page\", simRest.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"similar-restaurant-description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"similar-restaurant-card-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, simRest.name), __jsx(\"div\", {\n      className: \"similar-restaurant-card-rate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, simRest.rate, \"/5 (\", simRest.votes, \"+ votes)\"), __jsx(\"div\", {\n      className: \"similar-restaurant-card-address\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, simRest.address)), __jsx(\"div\", {\n      className: \"similar-restaurant-image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, __jsx(\"img\", {\n      src: simRest.imageUrl,\n      alt: \"similar-restaurant\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    })));\n  }))), __jsx(\"div\", {\n    className: \"detail-page-footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"footer-button-left\",\n    onClick: () => handleNavigation(\"left\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-chevron-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: \"footer-text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: \"footer-button-right\",\n    onClick: () => handleNavigation(\"right\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-chevron-right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  })))) : __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"no restaurant corresponding\");\n};\n\nconst mapStateToProps = state => {\n  return {\n    restaurants: state.restaurants\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    setRestaurants\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailMobile);","map":{"version":3,"sources":["/Users/estellegresillon/Code/airbnb-redux/src/components/detail/detail-mobile.jsx"],"names":["React","useState","useEffect","useRef","connect","bindActionCreators","setRestaurants","DetailMobile","props","restaurants","match","location","restaurant","setRestaurant","similarRestaurants","setSimilarRestaurants","nextRestaurantRef","previousRestaurantRef","detailPageTop","listedRestaurants","scrollToDetailTop","current","scrollIntoView","setNavigation","restaurantList","previous","next","forEach","val","i","id","toString","params","filterByType","filter","type","name","slice","detailRestaurant","window","scrollTo","handleNavigation","direction","history","push","pathname","goBack","award","description","backgroundImage","imageUrl","backgroundPosition","backgroundSize","price","rate","votes","address","openingHours","phone","menuLink","foodlabreview","reviews","map","review","date","comment","imageUrl2","length","simRest","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport { setRestaurants } from \"../../actions\";\n\nconst DetailMobile = props => {\n  const { setRestaurants, restaurants, match, location } = props;\n  const [restaurant, setRestaurant] = useState({});\n  const [similarRestaurants, setSimilarRestaurants] = useState([]);\n  const nextRestaurantRef = useRef(null);\n  const previousRestaurantRef = useRef(null);\n  const detailPageTop = useRef(null);\n  const listedRestaurants = location.listedRestaurants;\n\n  const scrollToDetailTop = () => {\n    detailPageTop.current.scrollIntoView();\n  }\n\n  const setNavigation = restaurantList => {\n    let previous;\n    let next;\n\n    restaurantList.forEach((val, i) => {\n      if (val.id.toString() === match.params.id) {\n        previous = restaurantList[i - 1];\n        next = restaurantList[i + 1];\n      };\n    });\n\n    if (previous) {\n      previousRestaurantRef.current = previous.id;\n    };\n    if (next) {\n      nextRestaurantRef.current = next.id;\n    };\n  };\n  \n  // if a user arrives on the pageId directly \n  // he doesn't get the restaurant object in the props so we execute these 2 hooks\n  useEffect(() => { \n    if (!location.restaurant) {\n      setRestaurants(); \n    };\n  }, [location.restaurant, setRestaurants]);\n\n  useEffect(() => {\n    if (location.listedRestaurants) {\n      setNavigation(location.listedRestaurants);\n    } else {//\n      setNavigation(restaurants);\n    };\n\n    if (location.restaurant) {\n      setRestaurant(location.restaurant);\n\n      const filterByType = [...restaurants].filter(val => {\n        if (val.type && val.name !== location.restaurant.name) {\n          return val.type === location.restaurant.type;\n        } else return null;\n      });\n  \n      setSimilarRestaurants(filterByType.slice(0, 6));\n    } else {\n      const detailRestaurant = [...restaurants].filter(val => {\n        if (val.id) {\n          return val.id.toString() === match.params.id;\n        } else return null;\n      });\n  \n      setRestaurant(detailRestaurant[0]);\n\n      const filterByType = [...restaurants].filter(val => {\n        if (val.type && val.name !== detailRestaurant[0].name) {\n          return val.type === detailRestaurant[0].type;\n        } else return null;\n      });\n  \n      setSimilarRestaurants(filterByType.slice(0, 6));\n    };\n  // eslint-disable-next-line\n  }, [location.restaurant, restaurants, match.params.id]);\n\n  // go to top because it keeps the same scroll position as the previous page\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n\n  const handleNavigation = (direction, id) => {\n    if (direction === \"left\") {\n      if (previousRestaurantRef.current) {\n        props.history.push({ pathname: `/detail/${previousRestaurantRef.current}`, listedRestaurants });\n      };\n    } else if (direction === \"next-page\") {\n      props.history.push({ pathname: `/detail/${id}`, listedRestaurants });\n    } else if (direction === \"right\") {\n      if (nextRestaurantRef.current) {\n        props.history.push({ pathname: `/detail/${nextRestaurantRef.current}`, listedRestaurants });\n      };\n    };\n\n    scrollToDetailTop();\n  };\n\n  return restaurant ? (\n    <div className=\"detail-page-wrapper-mobile\">\n      <div className=\"button-go-back\" onClick={() => props.history.goBack()}>\n        <i className=\"fas fa-chevron-left\" /> Retour\n      </div>\n      {restaurant.award &&\n        <div className=\"detail-page-award\">\n          {restaurant.award.description}\n        </div>}\n      <div \n        className=\"detail-page-big-img\"\n        style={{ \n          backgroundImage: `url(${restaurant.imageUrl})`,\n          backgroundPosition: \"center\",\n          backgroundSize: \"cover\",\n        }}\n      />\n      <div key={location.pathname} className=\"detail-page-content\">\n        <div className=\"detail-page-title\">{restaurant.name}</div>\n        <ul className=\"detail-page-resume\">\n          <li><span className=\"bolder\">Type :</span> {restaurant.type} ({restaurant.price})</li>\n          <li><span className=\"bolder\">Note :</span> {restaurant.rate}/5 (+ de {restaurant.votes} votes Google)</li>\n          <li>{restaurant.address}</li>\n          <li><span className=\"bolder\">Horaires :</span> {restaurant.openingHours}</li>\n          <li><span className=\"bolder\">Téléphone :</span> {restaurant.phone || \"Non communiqué\"}</li>\n          <li>\n            <a \n              href={restaurant.menuLink}\n              target=\"_blank\"\n              className=\"see-menu\"\n              rel=\"noopener noreferrer\"\n            >Voir le menu</a>\n          </li>\n        </ul>\n      </div>\n      <div className=\"detail-page-reviews\">\n        <div className=\"foodlab-review\">\n          <div className=\"foodlab-review-title\">Avis FoodLab : </div>\n          {restaurant.foodlabreview ? `« ${restaurant.foodlabreview} »` : \"Rédaction en cours\"}\n        </div>\n        <ul className=\"customers-reviews\">\n          {restaurant.reviews ? restaurant.reviews.map((review, i) => {\n            return (\n              <li key={i}>\n          <div className=\"review-date\">Review utilisateur {i + 1} - le {review.date} :</div>\n                <div className=\"review-comment\">\"{review.comment}\"</div>\n              </li>\n            )\n          }) : <li>Pas de reviews enregistrées</li>}\n        </ul>\n      </div>\n      {restaurant.imageUrl2 && \n        <div \n          className=\"detail-page-cropped-img\"\n          style={{ \n            backgroundImage: `url(${restaurant.imageUrl2})`,\n            backgroundPosition: \"right\",\n            backgroundSize: \"cover\",\n          }}\n        />}\n      {similarRestaurants.length > 0 &&\n        <div className=\"bottom-section\">\n          <div className=\"bottom-section-title\">Restaurants similaires :</div>\n          <div className=\"similar-restaurants-wrapper\">\n            {similarRestaurants.map(simRest => {\n              return (\n                <div \n                  className=\"similar-restaurant-card\"\n                  key={simRest.id}\n                  onClick={() => handleNavigation(\"next-page\", simRest.id)}\n                >\n                  <div className=\"similar-restaurant-description\">\n                    <div className=\"similar-restaurant-card-name\">{simRest.name}</div>\n                    <div className=\"similar-restaurant-card-rate\">{simRest.rate}/5 ({simRest.votes}+ votes)</div>\n                    <div className=\"similar-restaurant-card-address\">{simRest.address}</div>\n                  </div>\n                  <div className=\"similar-restaurant-image\">\n                    <img src={simRest.imageUrl} alt=\"similar-restaurant\" />\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>}\n      <div className=\"detail-page-footer\">\n        <div \n          className=\"footer-button-left\"\n          onClick={() => handleNavigation(\"left\")}\n        >\n          <i className=\"fas fa-chevron-left\" />\n        </div>\n        <div className=\"footer-text\"></div>\n        <div \n          className=\"footer-button-right\"\n          onClick={() => handleNavigation(\"right\")}\n        >\n          <i className=\"fas fa-chevron-right\" />\n        </div>\n      </div>\n    </div>\n  ) :\n  <div>no restaurant corresponding</div>\n};\n\nconst mapStateToProps = state => {\n  return {\n    restaurants: state.restaurants,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({ setRestaurants }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailMobile);\n"]},"metadata":{},"sourceType":"module"}